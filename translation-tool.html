
<!-- Original prototype file within social-app repo - save to relocate card styles in new structure -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gander Social - Indigenous Language Translation Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .setup-section {
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }

        .file-loader {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-loader:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .file-loader.dragover {
            border-color: #667eea;
            background: #e3f2fd;
        }

        .file-input {
            display: none;
        }

        .load-instructions {
            color: #6c757d;
            margin-bottom: 15px;
        }

        .language-selector {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .language-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .language-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
        }

        .language-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .language-card.active {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .language-card.loaded {
            border-color: #28a745;
        }

        .language-card h3 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .language-card p {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .language-status {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #dc3545;
        }

        .language-status.loaded {
            background: #28a745;
        }

        .translation-workspace {
            padding: 30px;
            display: none;
        }

        .workspace-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-bar {
            width: 200px;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-size: 0.85rem;
            color: #495057;
            font-weight: 500;
        }

        .filter-select, .search-box {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .search-box {
            min-width: 250px;
        }

        .pagination-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .pagination-info {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .translation-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .translation-card.translated {
            border-left-color: #28a745;
        }

        .translation-card.empty {
            border-left-color: #dc3545;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .message-info {
            font-family: 'Monaco', 'Consolas', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
        }

        .translation-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-indicator.completed {
            background: #28a745;
        }

        .status-indicator.empty {
            background: #dc3545;
        }

        .original-text {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .original-text h4 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .text-content {
            color: #2c3e50;
            font-size: 1rem;
            word-wrap: break-word;
        }

        .translation-input {
            width: 100%;
            min-height: 80px;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .translation-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .translation-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .placeholder-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.85rem;
            color: #856404;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: #6c757d;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #c3e6cb;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .workspace-header {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .pagination-controls {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>🪶 Indigenous Language Translation Tool</h1>
        <p>Gander Social - Supporting Canadian Indigenous Languages</p>
    </div>

    <div class="setup-section">
        <h3>Load Translation Files</h3>
        <p class="load-instructions">
            Load your messages.po files from: <code>/VSCode/Gander-Social/social-app/src/locale/locales/[lang]/messages.po</code>
        </p>

        <div class="file-loader" id="fileLoader">
            <div style="font-size: 2rem; margin-bottom: 15px;">📁</div>
            <div style="font-size: 1.2rem; margin-bottom: 10px;">
                Drop .po files here or click to browse
            </div>
            <div style="color: #6c757d; font-size: 0.9rem;">
                Load English template (en/messages.po) and target language files
            </div>
            <input type="file" id="fileInput" class="file-input" multiple accept=".po">
        </div>

        <div class="language-selector">
            <h3>Translation Languages</h3>
            <div class="language-grid">
                <div class="language-card" data-lang="cr">
                    <div class="language-status" id="status-cr"></div>
                    <h3>ᓀᐦᐃᔭᐍᐏᐣ (Cree)</h3>
                    <p>Plains Cree / Woods Cree</p>
                </div>
                <div class="language-card" data-lang="iu">
                    <div class="language-status" id="status-iu"></div>
                    <h3>ᐃᓄᒃᑎᑐᑦ (Inuktitut)</h3>
                    <p>Eastern Canadian Arctic</p>
                </div>
                <div class="language-card" data-lang="oj">
                    <div class="language-status" id="status-oj"></div>
                    <h3>ᐊᓂᔑᓈᐯᒧᐎᓐ (Ojibwe)</h3>
                    <p>Anishinaabemowin</p>
                </div>
                <div class="language-card" data-lang="miq">
                    <div class="language-status" id="status-miq"></div>
                    <h3>Mi'kmaq</h3>
                    <p>Mi'kmawi'simk</p>
                </div>
                <div class="language-card" data-lang="innu">
                    <div class="language-status" id="status-innu"></div>
                    <h3>Innu-aimun</h3>
                    <p>Montagnais</p>
                </div>
            </div>
        </div>
    </div>

    <div class="translation-workspace" id="workspace">
        <div class="workspace-header">
            <div class="progress-info">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <span id="progressText">0 / 0</span>
            </div>
            <div class="controls">
                <button class="btn btn-success" onclick="saveAllTranslations()">💾 Save All</button>
                <button class="btn btn-primary" onclick="exportTranslations()">📥 Export</button>
                <button class="btn btn-secondary" onclick="generatePOFile()">📄 Generate .po</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Total Messages</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="translatedCount">0</div>
                <div class="stat-label">Translated</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="emptyCount">0</div>
                <div class="stat-label">Untranslated</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentPage">1</div>
                <div class="stat-label">Current Page</div>
            </div>
        </div>

        <div class="filter-controls">
            <div class="filter-group">
                <label>Filter by Status</label>
                <select class="filter-select" id="statusFilter">
                    <option value="all">All Messages</option>
                    <option value="empty">Untranslated Only</option>
                    <option value="translated">Translated Only</option>
                </select>
            </div>
            <div class="filter-group">
                <label>Search Messages</label>
                <input type="text" class="search-box" id="searchBox" placeholder="Search original text...">
            </div>
            <div class="filter-group">
                <label>Sort by</label>
                <select class="filter-select" id="sortFilter">
                    <option value="original">Original Order</option>
                    <option value="alphabetical">Alphabetical</option>
                    <option value="length">By Length</option>
                    <option value="status">By Status</option>
                </select>
            </div>
        </div>

        <div class="pagination-controls">
            <button class="btn btn-secondary" id="prevPage" onclick="previousPage()" disabled>← Previous</button>
            <div class="pagination-info">
                Page <span id="pageInfo">1 of 1</span>
            </div>
            <button class="btn btn-secondary" id="nextPage" onclick="nextPage()" disabled>Next →</button>
            <div class="page-size-selector">
                <label>Show:</label>
                <select id="pageSizeSelect" onchange="changePageSize()">
                    <option value="10">10 per page</option>
                    <option value="25" selected>25 per page</option>
                    <option value="50">50 per page</option>
                    <option value="100">100 per page</option>
                </select>
            </div>
        </div>

        <div id="translationCards"></div>

        <div class="pagination-controls">
            <button class="btn btn-secondary" onclick="previousPage()" disabled id="prevPageBottom">← Previous</button>
            <div class="pagination-info">
                Page <span id="pageInfoBottom">1 of 1</span>
            </div>
            <button class="btn btn-secondary" onclick="nextPage()" disabled id="nextPageBottom">Next →</button>
        </div>
    </div>
</div>

<script>
    // Application state
    let templateMessages = {}; // English template messages
    let currentLanguage = '';
    let translations = {}; // All language translations
    let filteredMessages = [];
    let currentPage = 1;
    let pageSize = 25;
    let totalPages = 1;

    // Database for efficient storage
    let db;

    const supportedLanguages = {
        'cr': 'Cree (ᓀᐦᐃᔭᐍᐏᐣ)',
        'iu': 'Inuktitut (ᐃᓄᒃᑎᑐᑦ)',
        'oj': 'Ojibwe (ᐊᓂᔑᓈᐯᒧᐎᓐ)',
        'miq': "Mi'kmaq",
        'innu': 'Innu-aimun'
    };

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
        initializeDatabase();
        setupEventListeners();
    });

    // Initialize IndexedDB for efficient storage
    function initializeDatabase() {
        const request = indexedDB.open('GanderTranslations', 1);

        request.onerror = function(event) {
            console.error('Database error:', event.target.error);
        };

        request.onsuccess = function(event) {
            db = event.target.result;
            loadSavedProgress();
        };

        request.onupgradeneeded = function(event) {
            db = event.target.result;

            // Create object stores
            if (!db.objectStoreNames.contains('messages')) {
                db.createObjectStore('messages', { keyPath: 'msgid' });
            }

            if (!db.objectStoreNames.contains('translations')) {
                const translationStore = db.createObjectStore('translations', { keyPath: ['language', 'msgid'] });
                translationStore.createIndex('language', 'language', { unique: false });
            }
        };
    }

    // Setup event listeners
    function setupEventListeners() {
        const fileLoader = document.getElementById('fileLoader');
        const fileInput = document.getElementById('fileInput');

        // File drag and drop
        fileLoader.addEventListener('click', () => fileInput.click());
        fileLoader.addEventListener('dragover', handleDragOver);
        fileLoader.addEventListener('drop', handleFileDrop);
        fileInput.addEventListener('change', handleFileSelect);

        // Language selection
        document.querySelectorAll('.language-card').forEach(card => {
            card.addEventListener('click', function() {
                if (this.classList.contains('loaded')) {
                    selectLanguage(this.dataset.lang);
                }
            });
        });

        // Filters and search
        document.getElementById('statusFilter').addEventListener('change', applyFilters);
        document.getElementById('searchBox').addEventListener('input', debounce(applyFilters, 500));
        document.getElementById('sortFilter').addEventListener('change', applyFilters);
    }

    // Handle file drag over
    function handleDragOver(e) {
        e.preventDefault();
        e.currentTarget.classList.add('dragover');
    }

    // Handle file drop
    function handleFileDrop(e) {
        e.preventDefault();
        e.currentTarget.classList.remove('dragover');
        const files = Array.from(e.dataTransfer.files).filter(file => file.name.endsWith('.po'));
        processFiles(files);
    }

    // Handle file selection
    function handleFileSelect(e) {
        const files = Array.from(e.target.files).filter(file => file.name.endsWith('.po'));
        processFiles(files);
    }

    // Process uploaded .po files
    async function processFiles(files) {
        if (files.length === 0) {
            showMessage('Please select .po files to load.', 'error');
            return;
        }

        showLoading('Processing files...');

        for (const file of files) {
            try {
                const content = await readFileContent(file);
                const messages = parsePOFile(content);

                // Determine language from filename or path
                const language = detectLanguageFromFile(file.name);

                if (language === 'en') {
                    templateMessages = messages;
                    await saveMessagesToDB(messages);
                    showMessage(`Loaded ${Object.keys(messages).length} template messages`, 'success');
                } else if (supportedLanguages[language]) {
                    translations[language] = messages;
                    await saveTranslationsToDb(language, messages);
                    markLanguageLoaded(language);
                    showMessage(`Loaded ${Object.keys(messages).length} ${supportedLanguages[language]} translations`, 'success');
                } else {
                    console.warn(`Unknown language for file: ${file.name}`);
                }
            } catch (error) {
                showMessage(`Error processing ${file.name}: ${error.message}`, 'error');
            }
        }

        hideLoading();

        if (Object.keys(templateMessages).length > 0) {
            enableLanguageSelection();
        }
    }

    // Read file content
    function readFileContent(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = e => resolve(e.target.result);
            reader.onerror = reject;
            reader.readAsText(file, 'utf-8');
        });
    }

    // Parse .po file content
    function parsePOFile(content) {
        const messages = {};
        const lines = content.split('\n');

        let currentMsgid = '';
        let currentMsgstr = '';
        let inMsgid = false;
        let inMsgstr = false;

        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();

            // Skip comments and empty lines
            if (!line || line.startsWith('#')) {
                continue;
            }

            // Handle msgid
            if (line.startsWith('msgid ')) {
                // Save previous message if exists
                if (currentMsgid) {
                    messages[currentMsgid] = currentMsgstr;
                }

                currentMsgid = parseQuotedString(line.substring(6));
                currentMsgstr = '';
                inMsgid = true;
                inMsgstr = false;
            }
            // Handle msgstr
            else if (line.startsWith('msgstr ')) {
                currentMsgstr = parseQuotedString(line.substring(7));
                inMsgid = false;
                inMsgstr = true;
            }
            // Handle continuation lines
            else if (line.startsWith('"') && (inMsgid || inMsgstr)) {
                const continuation = parseQuotedString(line);
                if (inMsgid) {
                    currentMsgid += continuation;
                } else if (inMsgstr) {
                    currentMsgstr += continuation;
                }
            }
        }

        // Don't forget the last message
        if (currentMsgid) {
            messages[currentMsgid] = currentMsgstr;
        }

        // Remove empty msgid (header)
        delete messages[''];

        return messages;
    }

    // Parse quoted string from .po format
    function parseQuotedString(quotedStr) {
        quotedStr = quotedStr.trim();
        if (quotedStr.startsWith('"') && quotedStr.endsWith('"')) {
            let content = quotedStr.slice(1, -1);
            content = content.replace(/\\"/g, '"');
            content = content.replace(/\\n/g, '\n');
            content = content.replace(/\\t/g, '\t');
            content = content.replace(/\\\\/g, '\\');
            return content;
        }
        return quotedStr;
    }

    // Detect language from filename
    function detectLanguageFromFile(filename) {
        // Extract language code from path like "messages.po" in different directories
        // Or from filename patterns
        const pathParts = filename.split('/');
        for (const part of pathParts) {
            if (supportedLanguages[part] || part === 'en') {
                return part;
            }
        }

        // Fallback: assume English if can't determine
        return 'en';
    }

    // Save messages to database
    async function saveMessagesToDB(messages) {
        const transaction = db.transaction(['messages'], 'readwrite');
        const store = transaction.objectStore('messages');

        for (const [msgid, msgstr] of Object.entries(messages)) {
            await store.put({ msgid, msgstr });
        }
    }

    // Save translations to database
    async function saveTranslationsToDb(language, messages) {
        const transaction = db.transaction(['translations'], 'readwrite');
        const store = transaction.objectStore('translations');

        for (const [msgid, msgstr] of Object.entries(messages)) {
            await store.put({ language, msgid, msgstr });
        }
    }

    // Mark language as loaded
    function markLanguageLoaded(language) {
        const statusIndicator = document.getElementById(`status-${language}`);
        const languageCard = document.querySelector(`[data-lang="${language}"]`);

        if (statusIndicator) {
            statusIndicator.classList.add('loaded');
        }
        if (languageCard) {
            languageCard.classList.add('loaded');
        }
    }

    // Enable language selection
    function enableLanguageSelection() {
        document.querySelectorAll('.language-card.loaded').forEach(card => {
            card.style.cursor = 'pointer';
        });
    }

    // Select language for translation
    function selectLanguage(language) {
        currentLanguage = language;

        // Update UI
        document.querySelectorAll('.language-card').forEach(card => {
            card.classList.remove('active');
        });
        document.querySelector(`[data-lang="${language}"]`).classList.add('active');

        // Show workspace
        document.getElementById('workspace').style.display = 'block';

        // Initialize translations for this language if not exists
        if (!translations[language]) {
            translations[language] = {};
        }

        // Load and display messages
        loadTranslationWorkspace();
    }

    // Load translation workspace
    async function loadTranslationWorkspace() {
        showLoading('Loading translation workspace...');

        // Merge template with existing translations
        const workingMessages = {};
        for (const msgid of Object.keys(templateMessages)) {
            workingMessages[msgid] = {
                original: templateMessages[msgid],
                translation: translations[currentLanguage][msgid] || ''
            };
        }

        filteredMessages = Object.entries(workingMessages);
        applyFilters();
        hideLoading();
    }

    // Apply filters and sorting
    function applyFilters() {
        const statusFilter = document.getElementById('statusFilter').value;
        const searchTerm = document.getElementById('searchBox').value.toLowerCase();
        const sortFilter = document.getElementById('sortFilter').value;

        // Filter by status
        let filtered = Object.entries(templateMessages).map(([msgid, original]) => ({
            msgid,
            original,
            translation: translations[currentLanguage][msgid] || ''
        }));

        if (statusFilter === 'empty') {
            filtered = filtered.filter(item => !item.translation.trim());
        } else if (statusFilter === 'translated') {
            filtered = filtered.filter(item => item.translation.trim());
        }

        // Filter by search term
        if (searchTerm) {
            filtered = filtered.filter(item =>
                item.original.toLowerCase().includes(searchTerm) ||
                item.translation.toLowerCase().includes(searchTerm)
            );
        }

        // Sort
        switch (sortFilter) {
            case 'alphabetical':
                filtered.sort((a, b) => a.original.localeCompare(b.original));
                break;
            case 'length':
                filtered.sort((a, b) => a.original.length - b.original.length);
                break;
            case 'status':
                filtered.sort((a, b) => {
                    const aHasTranslation = a.translation.trim() ? 1 : 0;
                    const bHasTranslation = b.translation.trim() ? 1 : 0;
                    return aHasTranslation - bHasTranslation;
                });
                break;
        }

        filteredMessages = filtered;
        currentPage = 1;
        updatePagination();
        displayCurrentPage();
        updateStats();
    }

    // Update pagination
    function updatePagination() {
        totalPages = Math.ceil(filteredMessages.length / pageSize);

        // Update pagination info
        document.getElementById('pageInfo').textContent = `${currentPage} of ${totalPages}`;
        document.getElementById('pageInfoBottom').textContent = `${currentPage} of ${totalPages}`;

        // Update buttons
        const prevButtons = document.querySelectorAll('#prevPage, #prevPageBottom');
        const nextButtons = document.querySelectorAll('#nextPage, #nextPageBottom');

        prevButtons.forEach(btn => {
            btn.disabled = currentPage <= 1;
        });

        nextButtons.forEach(btn => {
            btn.disabled = currentPage >= totalPages;
        });
    }

    // Display current page
    function displayCurrentPage() {
        const startIndex = (currentPage - 1) * pageSize;
        const endIndex = Math.min(startIndex + pageSize, filteredMessages.length);
        const pageMessages = filteredMessages.slice(startIndex, endIndex);

        const container = document.getElementById('translationCards');
        container.innerHTML = '';

        pageMessages.forEach((message, index) => {
            const card = createTranslationCard(message, startIndex + index);
            container.appendChild(card);
        });
    }

    // Create translation card
    function createTranslationCard(message, index) {
        const card = document.createElement('div');
        const hasTranslation = message.translation.trim() !== '';
        const hasPlaceholders = checkForPlaceholders(message.original);

        card.className = `translation-card ${hasTranslation ? 'translated' : 'empty'}`;

        card.innerHTML = `
                <div class="card-header">
                    <div class="message-info">Message ${index + 1}</div>
                    <div class="translation-status">
                        <div class="status-indicator ${hasTranslation ? 'completed' : 'empty'}"></div>
                        ${hasTranslation ? 'Translated' : 'Needs Translation'}
                    </div>
                </div>

                <div class="original-text">
                    <h4>Original Text (English)</h4>
                    <div class="text-content">${escapeHtml(message.original)}</div>
                    ${hasPlaceholders ? '<div class="placeholder-info">⚠️ This message contains placeholders like {username} or {count, plural, ...}. Please preserve them in your translation.</div>' : ''}
                </div>

                <textarea
                    class="translation-input"
                    placeholder="Enter ${supportedLanguages[currentLanguage]} translation here..."
                    data-msgid="${escapeHtml(message.msgid)}"
                >${escapeHtml(message.translation)}</textarea>

                <div class="translation-actions">
                    <div class="translation-status">
                        ${hasTranslation ? '✅ Translated' : '⏳ Needs Translation'}
                    </div>
                    <div>
                        <button class="btn btn-primary" onclick="saveTranslation('${escapeHtml(message.msgid)}')">Save</button>
                        <button class="btn btn-danger" onclick="clearTranslation('${escapeHtml(message.msgid)}')">Clear</button>
                    </div>
                </div>
            `;

        // Add auto-save functionality
        const textarea = card.querySelector('.translation-input');
        textarea.addEventListener('input', function() {
            debounce(() => saveTranslation(message.msgid), 1000)();
        });

        return card;
    }

    // Check for placeholders
    function checkForPlaceholders(text) {
        return /\{[^}]+\}/.test(text);
    }

    // Save individual translation
    async function saveTranslation(msgid) {
        const textarea = document.querySelector(`[data-msgid="${escapeHtml(msgid)}"]`);
        if (!textarea) return;

        const translation = textarea.value.trim();
        translations[currentLanguage][msgid] = translation;

        // Save to database
        if (db) {
            const transaction = db.transaction(['translations'], 'readwrite');
            const store = transaction.objectStore('translations');
            await store.put({ language: currentLanguage, msgid, msgstr: translation });
        }

        // Update UI
        updateCardStatus(textarea);
        updateStats();
    }

    // Submit translations to GitHub
    async function submitTranslations(translations) {
        const response = await fetch('/api/submit-to-github', {
            method: 'POST',
            body: JSON.stringify({
                language: currentLanguage,
                translations: translations,
                metadata: {
                    translator: userName,
                    email: userEmail,
                    timestamp: new Date().toISOString()
                }
            })
        });
    }

    // Clear translation
    function clearTranslation(msgid) {
        const textarea = document.querySelector(`[data-msgid="${escapeHtml(msgid)}"]`);
        if (!textarea) return;

        textarea.value = '';
        saveTranslation(msgid);
    }

    // Update card status
    function updateCardStatus(textarea) {
        const card = textarea.closest('.translation-card');
        const hasTranslation = textarea.value.trim() !== '';

        card.className = `translation-card ${hasTranslation ? 'translated' : 'empty'}`;

        const statusIndicator = card.querySelector('.status-indicator');
        const statusText = card.querySelector('.translation-status');

        statusIndicator.className = `status-indicator ${hasTranslation ? 'completed' : 'empty'}`;
        statusText.textContent = hasTranslation ? '✅ Translated' : '⏳ Needs Translation';
    }

    // Update statistics
    function updateStats() {
        const total = Object.keys(templateMessages).length;
        const translated = Object.values(translations[currentLanguage] || {}).filter(t => t.trim()).length;
        const empty = total - translated;
        const progress = total > 0 ? (translated / total) * 100 : 0;

        document.getElementById('totalCount').textContent = total;
        document.getElementById('translatedCount').textContent = translated;
        document.getElementById('emptyCount').textContent = empty;
        document.getElementById('currentPage').textContent = currentPage;
        document.getElementById('progressText').textContent = `${translated} / ${total}`;
        document.getElementById('progressFill').style.width = `${progress}%`;
    }

    // Pagination functions
    function previousPage() {
        if (currentPage > 1) {
            currentPage--;
            updatePagination();
            displayCurrentPage();
        }
    }

    function nextPage() {
        if (currentPage < totalPages) {
            currentPage++;
            updatePagination();
            displayCurrentPage();
        }
    }

    function changePageSize() {
        pageSize = parseInt(document.getElementById('pageSizeSelect').value);
        currentPage = 1;
        updatePagination();
        displayCurrentPage();
    }

    // Save all translations
    async function saveAllTranslations() {
        if (!db || !currentLanguage) return;

        showLoading('Saving all translations...');

        try {
            const transaction = db.transaction(['translations'], 'readwrite');
            const store = transaction.objectStore('translations');

            for (const [msgid, msgstr] of Object.entries(translations[currentLanguage])) {
                await store.put({ language: currentLanguage, msgid, msgstr });
            }

            showMessage('All translations saved successfully!', 'success');
        } catch (error) {
            showMessage('Error saving translations: ' + error.message, 'error');
        }

        hideLoading();
    }

    // Export translations
    function exportTranslations() {
        if (!currentLanguage || !translations[currentLanguage]) {
            showMessage('No translations to export', 'error');
            return;
        }

        const data = {
            language: currentLanguage,
            languageName: supportedLanguages[currentLanguage],
            translations: translations[currentLanguage],
            metadata: {
                exportDate: new Date().toISOString(),
                totalMessages: Object.keys(templateMessages).length,
                translatedMessages: Object.values(translations[currentLanguage]).filter(t => t.trim()).length,
                format: 'po-compatible'
            }
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `gander-social-${currentLanguage}-translations.json`;
        a.click();
        URL.revokeObjectURL(url);
    }

    // Generate .po file
    function generatePOFile() {
        if (!currentLanguage || !translations[currentLanguage]) {
            showMessage('No translations to generate .po file', 'error');
            return;
        }

        let poContent = `# Gander Social - ${supportedLanguages[currentLanguage]} Translation
# Generated on ${new Date().toISOString()}
#
msgid ""
msgstr ""
"Language: ${currentLanguage}\\n"
"MIME-Version: 1.0\\n"
"Content-Type: text/plain; charset=UTF-8\\n"
"Content-Transfer-Encoding: 8bit\\n"
"X-Generator: Gander Social Translation Tool\\n"

`;

        for (const [msgid, original] of Object.entries(templateMessages)) {
            const translation = translations[currentLanguage][msgid] || '';

            poContent += `msgid ${escapePoString(msgid)}\n`;
            poContent += `msgstr ${escapePoString(translation)}\n\n`;
        }

        const blob = new Blob([poContent], { type: 'text/plain; charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `messages-${currentLanguage}.po`;
        a.click();
        URL.revokeObjectURL(url);

        showMessage('PO file generated successfully!', 'success');
    }

    // Escape string for .po format
    function escapePoString(text) {
        text = text.replace(/\\/g, '\\\\');
        text = text.replace(/"/g, '\\"');
        text = text.replace(/\n/g, '\\n');
        text = text.replace(/\t/g, '\\t');
        return `"${text}"`;
    }

    // Load saved progress
    async function loadSavedProgress() {
        if (!db) return;

        try {
            const transaction = db.transaction(['translations'], 'readonly');
            const store = transaction.objectStore('translations');
            const index = store.index('language');

            for (const langCode of Object.keys(supportedLanguages)) {
                const request = index.getAll(langCode);
                request.onsuccess = function() {
                    const results = this.result;
                    if (results.length > 0) {
                        translations[langCode] = {};
                        results.forEach(item => {
                            translations[langCode][item.msgid] = item.msgstr;
                        });
                        markLanguageLoaded(langCode);
                    }
                };
            }
        } catch (error) {
            console.error('Error loading saved progress:', error);
        }
    }

    // Utility functions
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    function showLoading(message) {
        const loading = document.createElement('div');
        loading.className = 'loading';
        loading.id = 'loadingIndicator';
        loading.innerHTML = `
                <div class="spinner"></div>
                <div>${message}</div>
            `;
        document.body.appendChild(loading);
    }

    function hideLoading() {
        const loading = document.getElementById('loadingIndicator');
        if (loading) {
            loading.remove();
        }
    }

    function showMessage(message, type) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `${type}-message`;
        messageDiv.textContent = message;

        const container = document.querySelector('.container');
        container.insertBefore(messageDiv, container.firstChild);

        setTimeout(() => {
            messageDiv.remove();
        }, 5000);
    }
</script>
</body>
</html>



<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Gander Social - Indigenous Language Translation Tool</title>-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        body {-->
<!--            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;-->
<!--            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--            min-height: 100vh;-->
<!--            padding: 20px;-->
<!--        }-->

<!--        .container {-->
<!--            max-width: 1200px;-->
<!--            margin: 0 auto;-->
<!--            background: white;-->
<!--            border-radius: 12px;-->
<!--            box-shadow: 0 20px 40px rgba(0,0,0,0.1);-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .header {-->
<!--            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);-->
<!--            color: white;-->
<!--            padding: 30px;-->
<!--            text-align: center;-->
<!--        }-->

<!--        .header h1 {-->
<!--            font-size: 2.5rem;-->
<!--            margin-bottom: 10px;-->
<!--            font-weight: 300;-->
<!--        }-->

<!--        .header p {-->
<!--            opacity: 0.9;-->
<!--            font-size: 1.1rem;-->
<!--        }-->

<!--        .language-selector {-->
<!--            padding: 20px;-->
<!--            background: #f8f9fa;-->
<!--            border-bottom: 1px solid #e9ecef;-->
<!--        }-->

<!--        .language-grid {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));-->
<!--            gap: 15px;-->
<!--            margin-top: 15px;-->
<!--        }-->

<!--        .language-card {-->
<!--            background: white;-->
<!--            border: 2px solid #e9ecef;-->
<!--            border-radius: 8px;-->
<!--            padding: 15px;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            text-align: center;-->
<!--        }-->

<!--        .language-card:hover {-->
<!--            border-color: #667eea;-->
<!--            transform: translateY(-2px);-->
<!--            box-shadow: 0 8px 16px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .language-card.active {-->
<!--            border-color: #667eea;-->
<!--            background: #f0f4ff;-->
<!--        }-->

<!--        .language-card h3 {-->
<!--            color: #2c3e50;-->
<!--            margin-bottom: 5px;-->
<!--        }-->

<!--        .language-card p {-->
<!--            color: #6c757d;-->
<!--            font-size: 0.9rem;-->
<!--        }-->

<!--        .translation-workspace {-->
<!--            padding: 30px;-->
<!--        }-->

<!--        .workspace-header {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: center;-->
<!--            margin-bottom: 30px;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 15px;-->
<!--        }-->

<!--        .progress-info {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 15px;-->
<!--        }-->

<!--        .progress-bar {-->
<!--            width: 200px;-->
<!--            height: 8px;-->
<!--            background: #e9ecef;-->
<!--            border-radius: 4px;-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .progress-fill {-->
<!--            height: 100%;-->
<!--            background: linear-gradient(90deg, #667eea, #764ba2);-->
<!--            transition: width 0.3s ease;-->
<!--        }-->

<!--        .controls {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            flex-wrap: wrap;-->
<!--        }-->

<!--        .btn {-->
<!--            padding: 10px 20px;-->
<!--            border: none;-->
<!--            border-radius: 6px;-->
<!--            cursor: pointer;-->
<!--            font-size: 0.9rem;-->
<!--            transition: all 0.3s ease;-->
<!--            text-decoration: none;-->
<!--            display: inline-flex;-->
<!--            align-items: center;-->
<!--            gap: 8px;-->
<!--        }-->

<!--        .btn-primary {-->
<!--            background: #667eea;-->
<!--            color: white;-->
<!--        }-->

<!--        .btn-primary:hover {-->
<!--            background: #5a6fd8;-->
<!--        }-->

<!--        .btn-secondary {-->
<!--            background: #6c757d;-->
<!--            color: white;-->
<!--        }-->

<!--        .btn-secondary:hover {-->
<!--            background: #5a6268;-->
<!--        }-->

<!--        .btn-success {-->
<!--            background: #28a745;-->
<!--            color: white;-->
<!--        }-->

<!--        .btn-success:hover {-->
<!--            background: #218838;-->
<!--        }-->

<!--        .translation-card {-->
<!--            background: #f8f9fa;-->
<!--            border-radius: 12px;-->
<!--            padding: 25px;-->
<!--            margin-bottom: 20px;-->
<!--            border-left: 4px solid #667eea;-->
<!--        }-->

<!--        .message-id {-->
<!--            font-family: 'Monaco', 'Consolas', monospace;-->
<!--            background: #2c3e50;-->
<!--            color: #ecf0f1;-->
<!--            padding: 8px 12px;-->
<!--            border-radius: 6px;-->
<!--            font-size: 0.85rem;-->
<!--            margin-bottom: 15px;-->
<!--            display: inline-block;-->
<!--        }-->

<!--        .original-text {-->
<!--            background: white;-->
<!--            border: 1px solid #dee2e6;-->
<!--            border-radius: 8px;-->
<!--            padding: 15px;-->
<!--            margin-bottom: 15px;-->
<!--            line-height: 1.6;-->
<!--        }-->

<!--        .original-text h4 {-->
<!--            color: #495057;-->
<!--            margin-bottom: 10px;-->
<!--            font-size: 0.9rem;-->
<!--            text-transform: uppercase;-->
<!--            letter-spacing: 0.5px;-->
<!--        }-->

<!--        .text-content {-->
<!--            color: #2c3e50;-->
<!--            font-size: 1rem;-->
<!--        }-->

<!--        .translation-input {-->
<!--            width: 100%;-->
<!--            min-height: 80px;-->
<!--            padding: 15px;-->
<!--            border: 2px solid #dee2e6;-->
<!--            border-radius: 8px;-->
<!--            font-size: 1rem;-->
<!--            line-height: 1.5;-->
<!--            resize: vertical;-->
<!--            font-family: inherit;-->
<!--            transition: border-color 0.3s ease;-->
<!--        }-->

<!--        .translation-input:focus {-->
<!--            outline: none;-->
<!--            border-color: #667eea;-->
<!--            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);-->
<!--        }-->

<!--        .translation-actions {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: center;-->
<!--            margin-top: 15px;-->
<!--            flex-wrap: wrap;-->
<!--            gap: 10px;-->
<!--        }-->

<!--        .status {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 8px;-->
<!--            font-size: 0.9rem;-->
<!--        }-->

<!--        .status.completed {-->
<!--            color: #28a745;-->
<!--        }-->

<!--        .status.pending {-->
<!--            color: #ffc107;-->
<!--        }-->

<!--        .hidden {-->
<!--            display: none;-->
<!--        }-->

<!--        .stats {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));-->
<!--            gap: 15px;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .stat-card {-->
<!--            background: white;-->
<!--            border: 1px solid #dee2e6;-->
<!--            border-radius: 8px;-->
<!--            padding: 15px;-->
<!--            text-align: center;-->
<!--        }-->

<!--        .stat-number {-->
<!--            font-size: 1.5rem;-->
<!--            font-weight: bold;-->
<!--            color: #667eea;-->
<!--        }-->

<!--        .stat-label {-->
<!--            font-size: 0.8rem;-->
<!--            color: #6c757d;-->
<!--            text-transform: uppercase;-->
<!--            letter-spacing: 0.5px;-->
<!--        }-->

<!--        .filter-controls {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--            margin-bottom: 20px;-->
<!--            flex-wrap: wrap;-->
<!--            align-items: center;-->
<!--        }-->

<!--        .filter-select {-->
<!--            padding: 8px 12px;-->
<!--            border: 1px solid #dee2e6;-->
<!--            border-radius: 6px;-->
<!--            font-size: 0.9rem;-->
<!--        }-->

<!--        .search-box {-->
<!--            flex: 1;-->
<!--            min-width: 200px;-->
<!--            padding: 8px 12px;-->
<!--            border: 1px solid #dee2e6;-->
<!--            border-radius: 6px;-->
<!--            font-size: 0.9rem;-->
<!--        }-->

<!--        @media (max-width: 768px) {-->
<!--            .header h1 {-->
<!--                font-size: 2rem;-->
<!--            }-->

<!--            .workspace-header {-->
<!--                flex-direction: column;-->
<!--                align-items: stretch;-->
<!--            }-->

<!--            .translation-actions {-->
<!--                flex-direction: column;-->
<!--                align-items: stretch;-->
<!--            }-->
<!--        }-->

<!--        .placeholder-info {-->
<!--            background: #fff3cd;-->
<!--            border: 1px solid #ffeaa7;-->
<!--            border-radius: 6px;-->
<!--            padding: 10px;-->
<!--            margin-bottom: 10px;-->
<!--            font-size: 0.85rem;-->
<!--            color: #856404;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div class="container">-->
<!--    <div class="header">-->
<!--        <h1>🪶 Indigenous Language Translation Tool</h1>-->
<!--        <p>Gander Social - Supporting Canadian Indigenous Languages</p>-->
<!--    </div>-->

<!--    <div class="language-selector">-->
<!--        <h3>Select Language to Translate</h3>-->
<!--        <div class="language-grid">-->
<!--            <div class="language-card" data-lang="cr">-->
<!--                <h3>ᓀᐦᐃᔭᐍᐏᐣ (Cree)</h3>-->
<!--                <p>Plains Cree / Woods Cree</p>-->
<!--            </div>-->
<!--            <div class="language-card" data-lang="iu">-->
<!--                <h3>ᐃᓄᒃᑎᑐᑦ (Inuktitut)</h3>-->
<!--                <p>Eastern Canadian Arctic</p>-->
<!--            </div>-->
<!--            <div class="language-card" data-lang="oj">-->
<!--                <h3>ᐊᓂᔑᓈᐯᒧᐎᓐ (Ojibwe)</h3>-->
<!--                <p>Anishinaabemowin</p>-->
<!--            </div>-->
<!--            <div class="language-card" data-lang="miq">-->
<!--                <h3>Mi'kmaq</h3>-->
<!--                <p>Mi'kmawi'simk</p>-->
<!--            </div>-->
<!--            <div class="language-card" data-lang="innu">-->
<!--                <h3>Innu-aimun</h3>-->
<!--                <p>Montagnais</p>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="translation-workspace hidden" id="workspace">-->
<!--        <div class="workspace-header">-->
<!--            <div class="progress-info">-->
<!--                <div class="progress-bar">-->
<!--                    <div class="progress-fill" id="progressFill"></div>-->
<!--                </div>-->
<!--                <span id="progressText">0 / 0</span>-->
<!--            </div>-->
<!--            <div class="controls">-->
<!--                <button class="btn btn-secondary" onclick="exportTranslations()">📥 Export</button>-->
<!--                <button class="btn btn-primary" onclick="importTranslations()">📤 Import</button>-->
<!--                <button class="btn btn-success" onclick="saveProgress()">💾 Save Progress</button>-->
<!--            </div>-->
<!--        </div>-->

<!--        <div class="stats">-->
<!--            <div class="stat-card">-->
<!--                <div class="stat-number" id="totalCount">0</div>-->
<!--                <div class="stat-label">Total Messages</div>-->
<!--            </div>-->
<!--            <div class="stat-card">-->
<!--                <div class="stat-number" id="completedCount">0</div>-->
<!--                <div class="stat-label">Completed</div>-->
<!--            </div>-->
<!--            <div class="stat-card">-->
<!--                <div class="stat-number" id="pendingCount">0</div>-->
<!--                <div class="stat-label">Pending</div>-->
<!--            </div>-->
<!--        </div>-->

<!--        <div class="filter-controls">-->
<!--            <select class="filter-select" id="statusFilter">-->
<!--                <option value="all">All Messages</option>-->
<!--                <option value="pending">Pending Only</option>-->
<!--                <option value="completed">Completed Only</option>-->
<!--            </select>-->
<!--            <input type="text" class="search-box" id="searchBox" placeholder="Search messages...">-->
<!--        </div>-->

<!--        <div id="translationCards"></div>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    // Sample message data (would be loaded from the actual messages.po file)-->
<!--    const sampleMessages = {-->
<!--        "AEPJ6q": "(active)",-->
<!--        "VbgChC": "(contains embedded content)",-->
<!--        "L3PXBq": "(no email)",-->
<!--        "YEOVrK": "{count, plural, one {# follower} other {# followers}}",-->
<!--        "2Szrsw": "{count, plural, one {# following} other {# following}}",-->
<!--        "M4fjIB": "{count, plural, one {# hour} other {# hours}}",-->
<!--        "J6qsxL": "{count, plural, one {# like} other {# likes}}",-->
<!--        "PlVus2": "{count, plural, one {# minute} other {# minutes}}",-->
<!--        "12WvI9": "{0}d",-->
<!--        "NSSJsj": "{0}h",-->
<!--        "ZSWUwq": "{0}m",-->
<!--        "welcome.message": "Welcome to Gander Social!",-->
<!--        "user.profile": "View {username}'s profile",-->
<!--        "post.likes": "This post has {count, plural, one {# like} other {# likes}}",-->
<!--        "notification.follow": "{follower} started following you"-->
<!--    };-->

<!--    let currentLanguage = '';-->
<!--    let translations = {};-->
<!--    let filteredMessages = {};-->

<!--    // Initialize the application-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        setupLanguageSelection();-->
<!--        setupEventListeners();-->
<!--    });-->

<!--    function setupLanguageSelection() {-->
<!--        const languageCards = document.querySelectorAll('.language-card');-->
<!--        languageCards.forEach(card => {-->
<!--            card.addEventListener('click', function() {-->
<!--                const lang = this.dataset.lang;-->
<!--                selectLanguage(lang);-->
<!--            });-->
<!--        });-->
<!--    }-->

<!--    function setupEventListeners() {-->
<!--        document.getElementById('statusFilter').addEventListener('change', filterMessages);-->
<!--        document.getElementById('searchBox').addEventListener('input', filterMessages);-->
<!--    }-->

<!--    function selectLanguage(lang) {-->
<!--        currentLanguage = lang;-->

<!--        // Update UI-->
<!--        document.querySelectorAll('.language-card').forEach(card => {-->
<!--            card.classList.remove('active');-->
<!--        });-->
<!--        document.querySelector(`[data-lang="${lang}"]`).classList.add('active');-->

<!--        // Show workspace-->
<!--        document.getElementById('workspace').classList.remove('hidden');-->

<!--        // Initialize translations for this language-->
<!--        if (!translations[lang]) {-->
<!--            translations[lang] = {};-->
<!--        }-->

<!--        // Load messages-->
<!--        loadMessages();-->
<!--    }-->

<!--    function loadMessages() {-->
<!--        const messagesContainer = document.getElementById('translationCards');-->
<!--        messagesContainer.innerHTML = '';-->

<!--        filteredMessages = { ...sampleMessages };-->

<!--        Object.keys(filteredMessages).forEach(messageId => {-->
<!--            createTranslationCard(messageId, filteredMessages[messageId]);-->
<!--        });-->

<!--        updateStats();-->
<!--    }-->

<!--    function createTranslationCard(messageId, originalContent) {-->
<!--        const card = document.createElement('div');-->
<!--        card.className = 'translation-card';-->
<!--        card.dataset.messageId = messageId;-->

<!--        const originalText = extractDisplayText(originalContent);-->
<!--        const hasPlaceholders = checkForPlaceholders(originalText);-->
<!--        const currentTranslation = translations[currentLanguage][messageId] || '';-->
<!--        const isCompleted = currentTranslation.trim() !== '';-->

<!--        card.innerHTML = `-->
<!--                <div class="message-id">${messageId}</div>-->
<!--                <div class="original-text">-->
<!--                    <h4>Original Text (English)</h4>-->
<!--                    <div class="text-content">${originalText}</div>-->
<!--                    ${hasPlaceholders ? '<div class="placeholder-info">⚠️ This message contains placeholders like {0}, {username}, or {count, plural, ...}. Please keep them in your translation.</div>' : ''}-->
<!--                </div>-->
<!--                <textarea-->
<!--                    class="translation-input"-->
<!--                    placeholder="Enter ${getLanguageName(currentLanguage)} translation here..."-->
<!--                    data-message-id="${messageId}"-->
<!--                >${currentTranslation}</textarea>-->
<!--                <div class="translation-actions">-->
<!--                    <div class="status ${isCompleted ? 'completed' : 'pending'}">-->
<!--                        ${isCompleted ? '✅ Completed' : '⏳ Pending'}-->
<!--                    </div>-->
<!--                    <div>-->
<!--                        <button class="btn btn-primary" onclick="saveTranslation('${messageId}')">Save</button>-->
<!--                        <button class="btn btn-secondary" onclick="clearTranslation('${messageId}')">Clear</button>-->
<!--                    </div>-->
<!--                </div>-->
<!--            `;-->

<!--        document.getElementById('translationCards').appendChild(card);-->

<!--        // Add event listener for auto-save-->
<!--        const textarea = card.querySelector('.translation-input');-->
<!--        textarea.addEventListener('input', function() {-->
<!--            debounce(() => saveTranslation(messageId), 1000)();-->
<!--        });-->
<!--    }-->

<!--    function extractDisplayText(content) {-->
<!--        // .po files contain simple strings, no complex nested structures-->
<!--        return typeof content === 'string' ? content : String(content);-->
<!--    }-->

<!--    function checkForPlaceholders(text) {-->
<!--        // Check for ICU MessageFormat placeholders: {0}, {username}, {count, plural, ...}-->
<!--        return /\{[^}]+\}/.test(text) || /#/.test(text);-->
<!--    }-->

<!--    function getLanguageName(code) {-->
<!--        const names = {-->
<!--            'cr': 'Cree',-->
<!--            'iu': 'Inuktitut',-->
<!--            'oj': 'Ojibwe',-->
<!--            'miq': "Mi'kmaq",-->
<!--            'innu': 'Innu-aimun'-->
<!--        };-->
<!--        return names[code] || code;-->
<!--    }-->

<!--    function saveTranslation(messageId) {-->
<!--        const textarea = document.querySelector(`[data-message-id="${messageId}"]`);-->
<!--        const translation = textarea.value.trim();-->

<!--        translations[currentLanguage][messageId] = translation;-->

<!--        // Update status-->
<!--        const card = document.querySelector(`[data-message-id="${messageId}"]`);-->
<!--        const status = card.querySelector('.status');-->
<!--        const isCompleted = translation !== '';-->

<!--        status.className = `status ${isCompleted ? 'completed' : 'pending'}`;-->
<!--        status.textContent = isCompleted ? '✅ Completed' : '⏳ Pending';-->

<!--        updateStats();-->
<!--        saveToLocalStorage();-->
<!--    }-->

<!--    function clearTranslation(messageId) {-->
<!--        const textarea = document.querySelector(`[data-message-id="${messageId}"]`);-->
<!--        textarea.value = '';-->
<!--        saveTranslation(messageId);-->
<!--    }-->

<!--    function updateStats() {-->
<!--        const total = Object.keys(filteredMessages).length;-->
<!--        const completed = Object.keys(translations[currentLanguage] || {}).filter(-->
<!--            key => translations[currentLanguage][key].trim() !== ''-->
<!--        ).length;-->
<!--        const pending = total - completed;-->
<!--        const progress = total > 0 ? (completed / total) * 100 : 0;-->

<!--        document.getElementById('totalCount').textContent = total;-->
<!--        document.getElementById('completedCount').textContent = completed;-->
<!--        document.getElementById('pendingCount').textContent = pending;-->
<!--        document.getElementById('progressText').textContent = `${completed} / ${total}`;-->
<!--        document.getElementById('progressFill').style.width = `${progress}%`;-->
<!--    }-->

<!--    function filterMessages() {-->
<!--        const statusFilter = document.getElementById('statusFilter').value;-->
<!--        const searchTerm = document.getElementById('searchBox').value.toLowerCase();-->

<!--        const cards = document.querySelectorAll('.translation-card');-->
<!--        cards.forEach(card => {-->
<!--            const messageId = card.dataset.messageId;-->
<!--            const originalText = extractDisplayText(sampleMessages[messageId]).toLowerCase();-->
<!--            const translation = translations[currentLanguage][messageId] || '';-->
<!--            const isCompleted = translation.trim() !== '';-->

<!--            let showCard = true;-->

<!--            // Apply status filter-->
<!--            if (statusFilter === 'pending' && isCompleted) showCard = false;-->
<!--            if (statusFilter === 'completed' && !isCompleted) showCard = false;-->

<!--            // Apply search filter-->
<!--            if (searchTerm && !originalText.includes(searchTerm) && !messageId.toLowerCase().includes(searchTerm)) {-->
<!--                showCard = false;-->
<!--            }-->

<!--            card.style.display = showCard ? 'block' : 'none';-->
<!--        });-->
<!--    }-->

<!--    function exportTranslations() {-->
<!--        const data = {-->
<!--            language: currentLanguage,-->
<!--            translations: translations[currentLanguage] || {},-->
<!--            metadata: {-->
<!--                exportDate: new Date().toISOString(),-->
<!--                totalMessages: Object.keys(translations[currentLanguage] || {}).length,-->
<!--                completedTranslations: Object.keys(translations[currentLanguage] || {}).filter(-->
<!--                    key => translations[currentLanguage][key].trim() !== ''-->
<!--                ).length,-->
<!--                format: 'po-compatible'-->
<!--            }-->
<!--        };-->

<!--        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });-->
<!--        const url = URL.createObjectURL(blob);-->
<!--        const a = document.createElement('a');-->
<!--        a.href = url;-->
<!--        a.download = `gander-social-${currentLanguage}-translations.json`;-->
<!--        a.click();-->
<!--        URL.revokeObjectURL(url);-->
<!--    }-->

<!--    function importTranslations() {-->
<!--        const input = document.createElement('input');-->
<!--        input.type = 'file';-->
<!--        input.accept = '.json';-->

<!--        input.onchange = function(e) {-->
<!--            const file = e.target.files[0];-->
<!--            if (!file) return;-->

<!--            const reader = new FileReader();-->
<!--            reader.onload = function(e) {-->
<!--                try {-->
<!--                    const data = JSON.parse(e.target.result);-->
<!--                    if (data.translations) {-->
<!--                        translations[currentLanguage] = { ...translations[currentLanguage], ...data.translations };-->
<!--                        loadMessages();-->
<!--                        alert('Translations imported successfully!');-->
<!--                    }-->
<!--                } catch (error) {-->
<!--                    alert('Error importing translations: ' + error.message);-->
<!--                }-->
<!--            };-->
<!--            reader.readAsText(file);-->
<!--        };-->

<!--        input.click();-->
<!--    }-->

<!--    function saveProgress() {-->
<!--        saveToLocalStorage();-->
<!--        alert('Progress saved to browser storage!');-->
<!--    }-->

<!--    function saveToLocalStorage() {-->
<!--        localStorage.setItem('ganderSocialTranslations', JSON.stringify(translations));-->
<!--    }-->

<!--    function loadFromLocalStorage() {-->
<!--        const saved = localStorage.getItem('ganderSocialTranslations');-->
<!--        if (saved) {-->
<!--            try {-->
<!--                translations = JSON.parse(saved);-->
<!--            } catch (error) {-->
<!--                console.error('Error loading saved translations:', error);-->
<!--            }-->
<!--        }-->
<!--    }-->

<!--    // Utility function for debouncing-->
<!--    function debounce(func, wait) {-->
<!--        let timeout;-->
<!--        return function executedFunction(...args) {-->
<!--            const later = () => {-->
<!--                clearTimeout(timeout);-->
<!--                func(...args);-->
<!--            };-->
<!--            clearTimeout(timeout);-->
<!--            timeout = setTimeout(later, wait);-->
<!--        };-->
<!--    }-->

<!--    // Load saved translations on page load-->
<!--    loadFromLocalStorage();-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

